# 比较输出

查看失败测试用例的实际输出与预期答案之间的差异。

## 概述

比较输出功能在测试用例因答案错误（WA）而失败时提供可视化差异查看器。它突出显示程序实际输出与预期答案之间的差异，使识别差异变得容易。

## 用户交互

### 触发功能

**方法：比较按钮**
- 运行导致 WA（答案错误）的测试用例
- 比较/差异图标按钮出现在测试用例输出区域
- 点击按钮打开比较视图

### 前置条件

- 测试用例必须已运行
- 测试用例结果必须是 WA（答案错误）
- 实际输出和预期答案都必须存在

### UI 组件

**比较按钮**：
- 图标：比较箭头或差异图标
- 位置：在测试用例输出区域（最左侧按钮）
- 仅对 WA 判决可见

**比较视图**：
- 分屏视图显示预期与实际
- 差异以红色和绿色突出显示
- 逐行比较
- 并排或统一差异格式

## 内部操作

### 工作原理

1. **测试失败**：程序产生的输出与预期答案不匹配
2. **WA 判决**：比较器确定答案错误
3. **启用比较**：比较按钮变为可见
4. **用户点击**：打开比较模态/面板
5. **差异计算**：系统计算输出之间的差异
6. **显示**：显示突出显示的差异

### 比较算法

该功能执行：
- 逐行比较
- 基于设置处理空白
- 更改行的字符级差异
- 添加/删除的可视化突出显示

## 配置选项

### 比较行为

#### `cph-ng.comparing.regardPEAsAC`
- **类型**：`boolean`
- **默认值**：`false`
- **说明**：将格式错误视为接受
- **效果**：如果为 true，PE 情况不会显示为需要比较的 WA

#### `cph-ng.comparing.oleSize`
- **类型**：`number`
- **默认值**：`3`
- **说明**：OLE（输出限制超出）的最大输出行数差异
- **效果**：大的输出差异可能显示 OLE 而不是 WA

#### `cph-ng.comparing.ignoreError`
- **类型**：`boolean`
- **默认值**：`false`
- **说明**：比较时忽略 stderr
- **效果**：比较仅关注 stdout

## 比较功能

### 可视化指示器

- **红色（已删除）**：预期答案中的行但不在实际输出中
- **绿色（已添加）**：实际输出中的行但不在预期答案中
- **突出显示的字符**：行内的特定字符差异

### 设为答案

如果您确定预期答案错误：
- 可以点击"设为答案"按钮
- 更新预期答案以匹配实际输出
- 对于更正测试用例答案很有用

## 工作流程示例

### 调试答案错误

1. 运行测试用例
2. 结果显示"WA"
3. 点击比较按钮（差异图标）
4. 比较视图打开显示：
   ```
   预期：  42
   实际：  43
          ^^
   ```
5. 识别差异
6. 返回代码修复问题

### 修复预期答案

1. 测试用例显示 WA
2. 打开比较
3. 意识到预期答案不正确
4. 点击"设为答案"按钮
5. 预期答案更新为实际输出
6. 重新运行显示 AC（接受）

### 处理 PE（格式错误）

如果启用了 `regardPEAsAC` 且仅空白不同：
1. 测试用例显示 AC 而不是 WA
2. 不需要比较
3. 额外的空格/换行被忽略

## 相关功能

- [运行单个测试](run-single-test.md) - 生成输出以进行比较
- [运行所有测试](run-all-tests.md) - 多个比较
- [编辑测试用例](edit-test-case.md) - 修复预期答案
- [切换文件/内联](toggle-file-inline.md) - 对于大输出
